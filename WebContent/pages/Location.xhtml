<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<ui:include src="/include/IncludeHeader.xhtml"></ui:include>

<h:head>
	<script
		src="http://maps.google.com/maps/api/js?key=AIzaSyDXM9lmEguvVPQD50Jx6Lxl2cVeevCV50Y"
		type="text/javascript"></script>
</h:head>
<body>
	<!-- Esta parte es delicada la lista se llena en un bean "UserBean" -->
	<ui:include src="/include/HiAndByeTrans.xhtml"></ui:include>
	<ui:include src="/include/IncludeBanner.html"></ui:include>
	<ui:include src="/include/IncludeTransMenu.xhtml"></ui:include>


	<p:panel id="panel" header="Panel de edición de localizacion"
		styleClass="blockUser">
		<f:facet name="header">
							Datos generales de la localizacion
						</f:facet>
		<h:form id="LocationId" styleClass="distributerSelector">
			<p:inputText type="hidden" id="test" name="hidden1"
				value="#{LocationBean.center}">
				<p:ajax event="valueChange" />
			</p:inputText>
			<h:panelGrid id="panelLocation" columns="2" cellpadding="5">
				<h:outputText value="Platforma:" />
				<p:selectOneButton value="#{LocationBean.option}">
					<f:selectItem itemLabel="Direccion" itemValue="1" />
					<f:selectItem itemLabel="Coordenas" itemValue="2" />
					<f:selectItem itemLabel="Mapa" itemValue="3" />
					<p:ajax event="change" update="panelLocationDetail"
						listener="#{LocationBean.changeLanguage}" />
				</p:selectOneButton>

				<p:spacer />

			</h:panelGrid>

			<h:panelGrid id="panelLocationDetail" columns="1" cellpadding="5">
				<p:spacer />

				<p:dialog header="Mapa" widgetVar="dlg1" modal="true"
					resizable="false" id="dialogo1" height="400" width="80%"
					closeOnEscape="true">
					<h:outputText id="display2" value="#{LocationBean.center}"
						rendered="#{LocationBean.option == '1'}" style="font-weight: bold" />
				</p:dialog>

				<p:dialog header="Mapa" widgetVar="dlg2" modal="true"
					resizable="false" id="dialogo2" height="400" width="50%"
					closeOnEscape="true">
					<h:panelGrid id="panel1" columns="3" cellpadding="5">
						<p:outputLabel value="Latitud:" for="gpslat"
							rendered="#{LocationBean.option == '2'}" />
						<p:inputText id="gpslat"
							value="#{InstitutionBean.institution.location.latitude}"
							required="#{InstitutionBean.editDetail}"
							readonly="#{!(InstitutionBean.editDetail)}"
							rendered="#{LocationBean.option == '2'}"
							validatorMessage="Solo coordenadas papá">
							<p:ajax event="keyup" update="gpslatmsg" />
							<f:validateRegex pattern="(^-?[0-9]\d*(\.\d+)?$)" />
						</p:inputText>
						<p:message id="gpslatmsg" for="gpslat" display="text,tooltip" />

						<p:outputLabel value="Longitud:" for="gpslon"
							rendered="#{LocationBean.option == '2'}" />
						<p:inputText id="gpslon"
							value="#{InstitutionBean.institution.location.longitude}"
							required="#{InstitutionBean.editDetail}"
							readonly="#{!(InstitutionBean.editDetail)}"
							rendered="#{LocationBean.option == '2'}"
							validatorMessage="Solo coordenadas papá">
							<p:ajax event="keyup" update="gpslonmsg" />
							<f:validateRegex pattern="^-?[0-9]\d*(\.\d+)?$" />
						</p:inputText>
						<p:message id="gpslonmsg" for="gpslon" display="text,tooltip" />
					</h:panelGrid>
				</p:dialog>

				<p:dialog header="Mapa" widgetVar="dlg3" modal="true"
					resizable="false" id="dialogo3" height="400" width="80%"
					closeOnEscape="true">
					<p:gmap center="#{LocationBean.center}" zoom="13" type="HYBRID"
						id="mapitaNew" style="width:100%;height:400px"
						rendered="#{LocationBean.option == '3'}" />
				</p:dialog>
			</h:panelGrid>
		</h:form>
	</p:panel>
	<ui:include src="/include/IncludeFooter.html"></ui:include>
	<script>
		function ip_callback(o) {
			var latlong = "";
			latlong = latlong.concat(o.latitude, ",", o.longitude)
			document.getElementById("LocationId:test").value = latlong;
		}
	</script>
	<script src="http://freegeoip.net/json/?callback=ip_callback"></script>
</body>
</html>